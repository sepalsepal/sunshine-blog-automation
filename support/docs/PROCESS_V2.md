# Project Sunshine - 프로세스 v2.0

> **작성자:** 김부장 (프로젝트 총괄)
> **작성일:** 2026-01-25
> **버전:** 2.0
> **상태:** 즉시 시행

---

## 1. 개요

### 1.1 문서 목적

본 문서는 Project Sunshine 콘텐츠 제작 파이프라인의 **품질 게이트 기반 프로세스**를 정의합니다.
모든 에이전트는 본 프로세스를 숙지하고 준수해야 합니다.

### 1.2 도입 배경

**기존 프로세스의 문제점:**

| 문제 | 영향 | 발생 빈도 |
|------|------|----------|
| 최종 단계에서 품질 이슈 발견 | 전체 비용 낭비 | 빈번 |
| 브랜드 가이드라인 위반 | 재작업 필요 | 빈번 |
| 단계별 검증 부재 | 누적 오류 | 매번 |
| 합의 없는 진행 | 책임 불명확 | 매번 |

**2026-01-25 망고 콘텐츠 사례:**
- 7장 이미지 생성 완료 후 2장 브랜드 위반 발견
- fal.ai API 비용 7회 발생 후 2회 재발생 예정
- 총 작업시간 2분 25초 전액 낭비

---

## 2. 신규 프로세스 (v2.0)

### 2.1 전체 흐름도

```
┌─────────────────────────────────────────────────────────────────────┐
│                    Project Sunshine Pipeline v2.0                    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  [기획]                                                              │
│    ↓                                                                 │
│  ┌──────────────────────────────────────────────┐                   │
│  │ 🚦 GATE 1: Plan Review                       │                   │
│  │   - Safety Checker: 안전 정보 검증           │                   │
│  │   - Customer Advocate: 고객 관점 검토        │                   │
│  │   합의율 75% 이상 → 통과                     │                   │
│  └──────────────────────────────────────────────┘                   │
│    ↓ (통과 시)                                                       │
│  [프롬프트 생성]                                                     │
│    ↓                                                                 │
│  ┌──────────────────────────────────────────────┐                   │
│  │ 🚦 GATE 2: Prompt Review ★ CRITICAL ★       │                   │
│  │   - Brand Guardian: 가이드라인 준수 (필수)   │                   │
│  │   - Quality Auditor: 품질 검토               │                   │
│  │   - Cost Optimizer: 비용 효율성              │                   │
│  │   - Customer Advocate: 고객 관점             │                   │
│  │   합의율 75% 이상 + 평균 70점 이상 → 통과    │                   │
│  │   ❌ BLOCKING 이슈 시 즉시 중단              │                   │
│  └──────────────────────────────────────────────┘                   │
│    ↓ (통과 시에만 비용 발생 단계 진입)                               │
│  [이미지 생성] 💰 API 비용 발생                                      │
│    ↓                                                                 │
│  ┌──────────────────────────────────────────────┐                   │
│  │ 🚦 GATE 3: Image Review                      │                   │
│  │   - Brand Guardian: 생성 결과 검증           │                   │
│  │   - Quality Auditor: 이미지 품질             │                   │
│  └──────────────────────────────────────────────┘                   │
│    ↓                                                                 │
│  [텍스트 오버레이]                                                   │
│    ↓                                                                 │
│  ┌──────────────────────────────────────────────┐                   │
│  │ 🚦 GATE 4: Overlay Review                    │                   │
│  │   - Quality Auditor: 레이아웃 검증           │                   │
│  └──────────────────────────────────────────────┘                   │
│    ↓                                                                 │
│  [최종 검수]                                                         │
│    ↓                                                                 │
│  ┌──────────────────────────────────────────────┐                   │
│  │ 🚦 GATE 5: Final Quality Gate ★ ALL ★       │                   │
│  │   - Brand Guardian                           │                   │
│  │   - Safety Checker                           │                   │
│  │   - Quality Auditor                          │                   │
│  │   - Customer Advocate                        │                   │
│  │   전원 합의 필요                              │                   │
│  └──────────────────────────────────────────────┘                   │
│    ↓ (통과 시)                                                       │
│  [캡션 생성] → [게시]                                                │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 자동 수정 루프

각 Gate에서 불합격 시:

```
┌─────────────────────────────────────────┐
│           Gate 검토 결과                 │
├─────────────────────────────────────────┤
│ 합의율 < 75% OR 평균 < 70점             │
│            ↓                            │
│ ┌─────────────────────────────────────┐ │
│ │ 자동 수정 시도 (최대 3회)           │ │
│ │  1. 이슈 분석                       │ │
│ │  2. 자동 수정 함수 적용             │ │
│ │  3. 재검토                          │ │
│ └─────────────────────────────────────┘ │
│            ↓                            │
│ 3회 초과 시 → 파이프라인 중단           │
│ 담당자 수동 개입 필요                   │
└─────────────────────────────────────────┘
```

---

## 3. 검토자(Reviewer) 역할 정의

### 3.1 Brand Guardian (브랜드 수호자)

**담당:** 햇살이 캐릭터 및 브랜드 가이드라인 준수

**검토 항목:**
- [ ] 햇살이 캐릭터 설명 정확성 (10살 시니어 골든리트리버)
- [ ] 금지 용어 사용 여부 (puppy, young dog 등)
- [ ] 금지 포즈 암시 여부 (먹는 포즈, 만지는 포즈 등)
- [ ] 레이아웃 규격 준수 (v7 표준)

**BLOCKING 권한:** 있음 (위반 시 즉시 중단)

### 3.2 Safety Checker (안전 검증자)

**담당:** 음식 안전 정보 정확성

**검토 항목:**
- [ ] 주의사항 슬라이드 존재 여부
- [ ] 위험 음식의 경우 명확한 경고 포함
- [ ] 안전/위험 분류 정확성

**BLOCKING 권한:** 위험 음식 오분류 시

### 3.3 Quality Auditor (품질 감사자)

**담당:** 전반적 품질 및 일관성

**검토 항목:**
- [ ] 프롬프트 충분한 상세도
- [ ] 스타일 일관성
- [ ] 이미지 생성 성공률
- [ ] 텍스트 가독성

**BLOCKING 권한:** 없음

### 3.4 Cost Optimizer (비용 최적화자)

**담당:** 리소스 효율성

**검토 항목:**
- [ ] 중복 프롬프트 여부
- [ ] 적정 이미지 수
- [ ] 불필요한 API 호출 방지

**BLOCKING 권한:** 없음

### 3.5 Customer Advocate (고객 대변인)

**담당:** 고객 관점 검토

**검토 항목:**
- [ ] 정보 전달 명확성
- [ ] 오해 소지 여부
- [ ] 매력적인 콘텐츠인지
- [ ] 부정적 인상 요소 여부

**BLOCKING 권한:** 없음

---

## 4. 합의 기준

### 4.1 통과 조건

| 게이트 | 필수 검토자 | 합의율 | 최소 점수 |
|--------|------------|--------|----------|
| Gate 1 (Plan) | 2명 | 75% | 70점 |
| Gate 2 (Prompt) | 4명 | 75% | 70점 |
| Gate 3 (Image) | 2명 | 75% | 70점 |
| Gate 4 (Overlay) | 1명 | 100% | 70점 |
| Gate 5 (Final) | 4명 | 75% | 80점 |

### 4.2 BLOCKING 이슈 정의

다음 이슈 발견 시 **즉시 파이프라인 중단**:

1. **브랜드 위반**
   - 금지 용어 사용 (puppy, young 등)
   - 금지 포즈 포함 (먹는 포즈, 만지는 포즈)

2. **안전 위반**
   - 위험 음식을 안전으로 오표기
   - 필수 경고 누락

3. **법적 위험**
   - 저작권 위반 가능 요소
   - 허위/과장 정보

---

## 5. 에이전트별 책임

### 5.1 책임 매트릭스

| 단계 | 주담당 | 검토자 | 승인자 |
|------|--------|--------|--------|
| 기획 | 김차장 | Safety, Customer | 김부장 |
| 프롬프트 | 김작가 | Brand, Quality, Cost, Customer | 김부장 |
| 이미지 | 이작가 | Brand, Quality | 박과장 |
| 오버레이 | 박편집 | Quality | 박과장 |
| 최종검수 | 박과장 | ALL | 김부장 |
| 게시 | 김대리 | - | 김부장 |

### 5.2 이슈 발생 시 책임

| 이슈 유형 | 1차 책임 | 2차 책임 |
|----------|----------|----------|
| 브랜드 위반 | Brand Guardian | 해당 단계 주담당 |
| 품질 미달 | Quality Auditor | 해당 단계 주담당 |
| 비용 낭비 | Cost Optimizer | 김부장 |
| 고객 불만 | Customer Advocate | 전원 |

---

## 6. CLI 사용법

### 6.1 v2 파이프라인 실행

```bash
# 기본 실행 (Quality Gate 활성화)
python -m pipeline.pipeline_v2 mango

# 드라이런 (게시 스킵)
python -m pipeline.pipeline_v2 mango --dry-run
```

### 6.2 출력 예시

```
======================================================================
🌟 Project Sunshine Pipeline v2.0 - Quality Gate Enabled
======================================================================
📋 Topic: mango
======================================================================

[STAGE 1/6] 📋 기획 (Planning)
--------------------------------------------------
   🚦 Quality Gate 검토 중... (Plan Review Gate)

============================================================
🚦 Quality Gate: Plan Review Gate
============================================================
상태: APPROVED
합의율: 100.0%
수정 횟수: 0/3

✅ safety_checker: 100점
✅ customer_advocate: 100점
============================================================

✅ 기획 완료: 7 슬라이드

[STAGE 2/6] ✍️ 프롬프트 생성 (Prompt Generation)
--------------------------------------------------
⚠️  [CRITICAL GATE] 이미지 생성 비용 발생 전 최종 검증
   🚦 Quality Gate 검토 중... (Prompt Review Gate)

============================================================
🚦 Quality Gate: Prompt Review Gate (Pre-Image)
============================================================
상태: NEEDS_REVISION
합의율: 50.0%
수정 횟수: 0/3

❌ brand_guardian: 45점
   - [CRITICAL] 금지 포즈 'eating' 암시 (슬라이드 1)
✅ quality_auditor: 95점
✅ cost_optimizer: 100점
✅ customer_advocate: 85점
============================================================

   🔧 자동 수정 시도 (1/3)...
   ↩️  수정 완료, 재검토 진행...
```

---

## 7. 교육 체크리스트

### 7.1 전 에이전트 필수 숙지 사항

- [ ] 본 문서 전체 숙독
- [ ] 브랜드 가이드라인 암기 (금지 용어/포즈)
- [ ] v7 레이아웃 표준 숙지
- [ ] Quality Gate 통과 조건 이해
- [ ] BLOCKING 이슈 정의 숙지

### 7.2 역할별 추가 교육

**Brand Guardian:**
- [ ] `pipeline/quality_gate.py` 코드 리뷰
- [ ] 금지 포즈 이미지 예시 학습

**Quality Auditor:**
- [ ] 품질 점수 산정 기준 학습
- [ ] 과거 불합격 사례 분석

**Cost Optimizer:**
- [ ] API 비용 구조 이해
- [ ] 비용 절감 사례 학습

---

## 8. 시행 일정

| 일자 | 내용 |
|------|------|
| 2026-01-25 | 프로세스 v2.0 문서화 완료 |
| 2026-01-25 | Quality Gate 시스템 구현 완료 |
| 2026-01-25 | 전 에이전트 공지 및 교육 |
| 2026-01-26~ | v2.0 파이프라인 정식 적용 |

---

## 9. 부록

### 9.1 관련 파일

- `pipeline/quality_gate.py` - Quality Gate 시스템
- `pipeline/pipeline_v2.py` - v2 파이프라인
- `config/overlay_config.json` - 레이아웃 설정
- `agents/prompt_generator.py` - 프롬프트 템플릿

### 9.2 문의

프로세스 관련 문의: 김부장
기술 관련 문의: 최기술 대리

---

**본 프로세스는 2026-01-25부터 즉시 시행됩니다.**
**모든 에이전트는 본 문서를 숙지하고 서명 후 제출 바랍니다.**

---

서명란:

| 에이전트 | 서명 | 일자 |
|----------|------|------|
| 김차장 (기획) | ______ | ______ |
| 김작가 (프롬프트) | ______ | ______ |
| 이작가 (이미지) | ______ | ______ |
| 박편집 (오버레이) | ______ | ______ |
| 박과장 (검수) | ______ | ______ |
| 이카피 (캡션) | ______ | ______ |
| 김대리 (게시) | ______ | ______ |
