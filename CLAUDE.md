# 🚨 필수 규칙 (세션 시작 시 반드시 읽을 것)

**이 섹션은 모든 작업의 전제 조건이다. 읽지 않고 작업한 결과물은 전량 폐기.**

---

## 1. PRODUCTION_PIPELINE_RULE (모든 작업 적용)

모든 작업은 반드시 아래 5단계를 따를 것:

```
━━━━━ PIPELINE STATUS ━━━━━
[1] 규칙확인        ⬜
[2] 규칙잠금        ⬜
[3] 생성            ⬜
[4] 자가검증        ⬜
[5] 제출            ⬜
━━━━━━━━━━━━━━━━━━━━━━━━━━
```

- 상태 표시 없이 답변 금지
- 규칙확인 없이 생성하면 전량 무효
- 자가검증 없이 제출하면 PD 반려
- 상세: 00_rules/05_Pipeline_rules/PRODUCTION_PIPELINE_RULE.md

---

## 2. 규칙 체계 (00_rules/)

### 2.1 최상위 (헌법)

```
00_rules/RULES.md              ← 헌법. 최상위 규칙. 충돌 시 이것이 우선
00_rules/00_INDEX.md           ← 규칙 맵. 작업별 어디를 읽을지 안내
```

**모든 작업 시작 전 00_INDEX.md를 먼저 확인하여 해당 규칙 위치를 파악할 것.**

### 2.2 작업별 필수 참조 규칙

```
┌─────────────────┬────────────────────────────────────────────┐
│     작업        │  반드시 읽을 폴더/파일                      │
├─────────────────┼────────────────────────────────────────────┤
│ 캡션 생성       │ 00_rules/01_Caption_rules/                 │
│                 │   ├── CAPTION_RULE.md (3플랫폼 공통)       │
│                 │   ├── SAFETY_MATRIX.md (안전도 SSOT)       │
│                 │   └── 해당 플랫폼 폴더 (Blog/Insta/Thread) │
├─────────────────┼────────────────────────────────────────────┤
│ 인스타 캡션     │ 00_rules/01_Caption_rules/Insta/           │
│  (★ 필수)       │   └── INSTAGRAM_RULE.md (v1.0 골든샘플)    │
│                 │   - B안 후킹 (걱정 공감형)                  │
│                 │   - 한영 이중언어 구조                      │
│                 │   - 안전도별 4종 골든샘플 포함              │
│                 │   - 해시태그 15개 (영문10 + 한글5)          │
├─────────────────┼────────────────────────────────────────────┤
│ 표지 이미지     │ 00_rules/02_Image_rules/01_Cover/          │
│                 │   ├── COVER_RULE.md                        │
│                 │   └── COVER_PROMPT.md                      │
├─────────────────┼────────────────────────────────────────────┤
│ 음식 이미지     │ 00_rules/02_Image_rules/02_Food/           │
│                 │   ├── FOOD_RULE.md                         │
│                 │   └── FOOD_PROMPT.md                       │
├─────────────────┼────────────────────────────────────────────┤
│ 햇살이+음식     │ 00_rules/02_Image_rules/03_DogWithFood/    │
│                 │   ├── DOG_WITH_FOOD_RULE.md                │
│                 │   └── DOG_WITH_FOOD_PROMPT.md              │
├─────────────────┼────────────────────────────────────────────┤
│ 블로그 슬라이드 │ 00_rules/02_Image_rules/Blog_04-07/        │
│  (03~07)        │   ├── BLOG_SLIDE_DESIGN_RULE.md (v2.1)    │
│                 │   ├── SLIDE_NAMING_BY_SAFETY.md            │
│                 │   └── 해당 안전도 골든 샘플 폴더           │
├─────────────────┼────────────────────────────────────────────┤
│ 텍스트 오버레이 │ 00_rules/02_Image_rules/                   │
│                 │   └── TEXT_OVERLAY_RULE.md (v1.1)          │
├─────────────────┼────────────────────────────────────────────┤
│ 햇살이 실사     │ 00_rules/02_Image_rules/08_HaetsalReal/    │
│                 │   └── HAETSAL_REAL_RULE.md                 │
├─────────────────┼────────────────────────────────────────────┤
│ 폴더/파일 조작  │ 00_rules/03_Folder_rules/                  │
│                 │   ├── FOLDER_STRUCTURE.md                  │
│                 │   ├── NAMING_RULE.md                       │
│                 │   ├── FILE_MANAGEMENT_RULE.md              │
│                 │   └── CLOUDINARY_RULE.md                   │
├─────────────────┼────────────────────────────────────────────┤
│ QC / 검수       │ 00_rules/04_QC_rules/                      │
│                 │   ├── QC_CHECKLIST.md                      │
│                 │   └── REJECTION_CASES.md                   │
├─────────────────┼────────────────────────────────────────────┤
│ 파이프라인      │ 00_rules/05_Pipeline_rules/                │
│                 │   ├── PRODUCTION_PIPELINE_RULE.md (v1.1)   │
│                 │   ├── PIPELINE_STANDARD.md (v2.8)          │
│                 │   └── AGENT_STANDARD.md (v2.2)             │
└─────────────────┴────────────────────────────────────────────┘
```

### 2.3 안전도 판단

안전도 관련 판단이 필요하면 반드시:

```
00_rules/01_Caption_rules/SAFETY_MATRIX.md ← 유일한 기준 (SSOT)
```

이 파일 외의 기준으로 안전도를 판단하지 말 것.

### 2.4 골든 샘플 위치

```
캡션 골든:     00_rules/01_Caption_rules/{플랫폼}/GOLDEN_*.txt
캡션 템플릿:   00_rules/01_Caption_rules/{플랫폼}/{안전도}/Golden_*.txt
이미지 골든:   00_rules/02_Image_rules/{이미지유형}/Golden_*.png
슬라이드 골든: 00_rules/02_Image_rules/Blog_04-07/{안전도}/Golden_*.png
```

골든 샘플은 기준이다. 수정/삭제 금지. 원본 보존.

---

## 3. 규칙 우선순위

```
RULES.md (헌법)
    ↓
SAFETY_MATRIX.md (안전도 SSOT)
    ↓
각 카테고리 규칙 (CAPTION_RULE, COVER_RULE 등)
    ↓
골든 샘플 (시각적 기준)
```

충돌 시 상위 문서가 우선한다.

---

## 4. 금지 사항

```
❌ 규칙을 읽지 않고 작업
❌ 골든 샘플 없이 디자인 판단
❌ SAFETY_MATRIX 외 기준으로 안전도 판단
❌ PIPELINE STATUS 없이 응답
❌ FORBIDDEN 음식에 급여법/조리법 포함
❌ 골든 샘플 원본 수정/삭제
❌ PD 승인 없이 규칙 문서 수정
❌ 게시 완료 콘텐츠 수정 (이미 게시된 것은 수정 불필요)
```

---

## 5. 배치 작업 규칙

### 5.1 게시 상태 확인 필수

배치 검수/수정 작업 시작 전 반드시:

1. **노션에서 게시 상태 확인**
2. **마지막 게시 번호 파악**
3. **보고 형식으로 시작**

```
보고 형식:
"블로그 N번 {음식명}까지 게시되었습니다.
N+1번 {음식명}부터 검수 및 수정 작업 진행하겠습니다."
```

### 5.2 게시 완료 콘텐츠 원칙

- 이미 게시된 콘텐츠는 수정하지 않음
- 게시 완료 여부는 노션 DB 기준
- 수정이 필요한 경우 PD 승인 후 진행

---

## 6. 세션 시작 프로토콜

세션 시작 시 아래 순서로 진행:

```
1. 이 CLAUDE.md 읽기 (자동)
2. 작업 지시 확인
3. 00_INDEX.md에서 해당 규칙 위치 파악
4. 해당 규칙 파일 읽기
5. PIPELINE STATUS [1] 규칙확인부터 시작
```

---

**이 아래는 기존 CLAUDE.md 내용**

---

# Project Sunshine — Claude Code 운영 규칙

> 이 파일은 세션 시작 시 자동 로드됩니다.
> 아래 규칙을 읽지 않은 상태에서의 작업은 전부 무효입니다.

---

## 🔒 제1원칙: RULES.md가 유일한 기준

1. **RULES.md를 반드시 먼저 읽고 시작할 것**
   - 경로: `./00_rules/RULES.md`
   - 세션 시작 후 첫 작업 전에 반드시 전문 확인

2. **RULES.md에 없는 기준은 존재하지 않는 것으로 간주**
   - 과거 대화, 기억, 추론으로 규칙을 만들지 않음
   - "예전에 이렇게 했으니까"는 근거가 아님

3. **규칙 충돌 시 → 작업 중단 → PD에게 보고**
   - 자의적 판단으로 규칙을 우회하지 않음

---

## 📚 규칙 참조 (필수)

모든 작업 시작 전 반드시 해당 규칙을 읽을 것:

| 작업 | 참조 경로 |
|------|----------|
| 캡션 생성 | `00_rules/01_Caption_rules/` 전체 |
| 이미지 생성 | `00_rules/02_Image_rules/` 해당 파일 |
| 폴더/파일 조작 | `00_rules/03_Folder_rules/` 해당 파일 |
| QC | `00_rules/04_QC_rules/` 전체 |
| 파이프라인 | `00_rules/05_Pipeline_rules/` 전체 |
| 버전 관리 | `00_rules/06_Version_rules/` 전체 |

**규칙 인덱스:** `00_rules/00_INDEX.md`

⚠️ **규칙을 읽지 않고 작업한 결과물은 전량 폐기 대상.**

---

## 📋 핵심 SOP 목록 (RULES.md 내 위치)

| SOP | 위치 | 트리거 |
|-----|------|--------|
| 블로그 본문 제작 | §2~§6 | "OOO 본문 만들어" |
| 캡션 작성 | §6, §6.5, §6.6 | "OOO 캡션 만들어" |
| **인스타 캡션** | **Insta/INSTAGRAM_RULE.md** | **"OOO 인스타 캡션"** |
| 표지 생성 | §8 v2.0 | "OOO 표지 만들어" |
| 인스타+쓰레드 게시 | §9 | "OOO 게시해" |
| 네이버 블로그 HTML | §10 | "OOO 블로그 준비해" |

→ PD 지시가 위 트리거에 해당하면 RULES.md 해당 섹션의 SOP대로 실행.
→ 김부장 작업지시서 없이 직접 실행 가능.

---

## ⚠️ 금지 사항

1. **RULES.md를 읽지 않고 작업 시작하는 것**
2. **규칙에 없는 파라미터를 임의로 사용하는 것**
   - 표지: stroke_width 사용 금지 (§8.6)
   - 폰트: NotoSansCJK를 표지에 사용 금지 (§8.6)
3. **Cloudinary 중복 업로드** (§8.6, §9.3)
4. **Validator FAIL 상태에서 "완성"으로 보고하는 것** (§10.3.5)
5. **비용 발생 작업을 PD 승인 없이 실행하는 것**
6. **소스 파일 원본을 수정/이동하는 것** (원본보존원칙)

---

## 🔑 주요 경로

| 항목 | 경로 |
|------|------|
| 규칙 | `./00_rules/RULES.md` |
| 콘텐츠 | `./01_contents/` |
| 게시 완료 | `./01_contents/4_posted/` |
| 스크립트 | `./services/scripts/` |
| 표지 생성기 | `./services/scripts/cover_generator.py` |
| 로그 | `./config/logs/` |
| 환경변수 | `./.env` |

---

## 📊 콘텐츠 상태 폴더

```
01_contents/
├── 1_cover_only/     ← 표지만 (150개 대기)
├── 2_body_ready/     ← 본문 완료 (7개)
├── 3_approved/       ← PD 승인 (2개)
├── 4_posted/         ← 게시 완료 (42개)
├── 5_archived/       ← 비활성
└── 99_CleanReady/    ← 클린 이미지 대기/백업
    └── clean_backup/ ← 원본 소스 백업
        ├── cover/    ← 강아지+음식 이미지
        └── food/     ← 음식만 이미지
```

---

## 🗄️ 원본 백업 규칙

**원칙: 원본 소스는 작업 완료 후 반드시 `99_CleanReady/clean_backup/`에 백업**

### 분류 기준

| 이미지 유형 | 백업 폴더 | 설명 |
|------------|----------|------|
| 강아지+음식 | `clean_backup/cover/` | 표지용 원본 (햇살이 등장) |
| 음식만 | `clean_backup/food/` | 블로그 2번 이미지 원본 |

### 작업별 백업 위치

| 작업 | 백업 위치 |
|------|----------|
| 클린 이미지 분배 (표지용) | 원본 → `clean_backup/cover/` 이동 |
| 클린 이미지 분배 (음식용) | 원본 → `clean_backup/food/` 이동 |
| 블로그 2번 이미지 | 원본 → `clean_backup/food/` 복사 |
| 표지 소스 | 원본 → `clean_backup/cover/` 복사 |

**목적:** 원본 소스 복구 및 추적 가능

---

## 🎯 세션 시작 체크리스트

세션 시작 시 아래를 자동 수행:

1. ✅ 이 CLAUDE.md 읽음
2. ✅ RULES.md 전문 확인
3. ✅ .env 로드 확인 (API 키)
4. ✅ **PENDING 작업 확인** (아래 섹션)
5. ✅ PD 첫 지시 대기

**첫 응답에 아래 문구 포함:**
> "CLAUDE.md 로드 완료. RULES.md 기준으로만 작업합니다."

---

## 🚨 PENDING 작업 (세션 시작 시 PD에게 알림)

### 1. 클린 이미지 누락 (75개)
- **파일:** `config/PENDING_CLEAN_IMAGES.md`
- **내용:** 커버 생성에 필요한 클린 이미지 75개 누락
- **필요 조치:** PD가 클린 이미지 제작 후 각 폴더의 `00_Clean/`에 저장
- **완료 후:** `python3 services/scripts/cover_generator.py {번호}` 실행

**세션 시작 시 PD에게 알림:**
> "PENDING 작업 있음: 클린 이미지 75개 누락. `config/PENDING_CLEAN_IMAGES.md` 확인 바랍니다."

---

## 🏷️ 팀 구조

| 역할 | 담당 | 책임 |
|------|------|------|
| PD (박세준) | 최종 승인/게시 | 의사결정권자 |
| 김부장 (Opus) | 전략/검수 | 규칙 설계, 품질 판정 |
| 최부장 (Claude Code) | 실행 | 코드, 이미지, HTML 제작 |
| 레드2 (Gemini) | 리스크 분석 | 구조 결함 판정 |

---

## 📌 비용 규칙

- 유료 API 호출, 구독 서비스 등 비용 발생 작업은 실행 전 PD 승인 필수
- 무단 실행 시 규칙 위반으로 처리

---

_마지막 업데이트: 2026-02-16_
_버전: 3.1 (인스타 캡션 골든샘플 v1.0 추가)_
