# SunFlow 성과 기준 정의서

> **목적:** SunFlow v1.2의 성공/실패 판단 기준 명문화
> **Owner:** 김부장
> **Review Cycle:** 월 1회 (매월 1일)
> **Last Updated:** 2026-01-30
> **Status:** 1차 목표 기준 (실운영 데이터 기반 분기별 재평가 예정)

---

## 측정 방법론

### 데이터 수집
- **수집 도구:** `core/utils/metrics_collector.py`
- **저장 위치:** `config/data/daily_metrics.json`
- **수집 주기:** 실시간 (이벤트 기반)
- **집계 주기:** 일간/주간/월간 자동 집계

### 실패 정의
| 유형 | 정의 |
|------|------|
| 헬스체크 실패 | 7개 컴포넌트 중 1개 이상 UNHEALTHY |
| 게시 실패 | Instagram API 응답 코드 4xx/5xx 또는 타임아웃 |
| 가동 중단 | 연속 3회 헬스체크 실패 |

### 샘플링
- **최소 샘플:** 7일 (테스트 수준)
- **권장 샘플:** 30일 (운영 수준)
- **신뢰 구간:** 28일 이상 데이터 확보 시 95% 신뢰도

---

## 1. 시스템 안정성 기준

### 1.1 가동률 (Uptime)

| 지표 | 목표 | 최소 허용 | 측정 방법 |
|------|:----:|:---------:|-----------|
| **일간 가동률** | 99.5% | 98.0% | 헬스체크 성공률 |
| **주간 가동률** | 99.0% | 97.0% | 7일 평균 |
| **월간 가동률** | 98.5% | 95.0% | 30일 평균 |

**계산식:**
```
가동률 = (정상 헬스체크 횟수 / 전체 헬스체크 횟수) × 100
```

**측정 주기:** 매 5분 (launchd 스케줄)

### 1.2 게시 성공률

| 지표 | 목표 | 최소 허용 | 실패 시 조치 |
|------|:----:|:---------:|--------------|
| **단일 게시 성공률** | 98% | 95% | 자동 재시도 3회 |
| **주간 게시 성공률** | 95% | 90% | 원인 분석 후 수동 게시 |
| **크로스 포스팅 성공률** | 90% | 80% | 실패 플랫폼 스킵, 주 플랫폼 우선 |

**실패 정의:**
- Instagram API 에러
- Cloudinary 업로드 실패
- 이미지 생성 3회 재시도 후 실패
- 토큰 만료

### 1.3 복구 시간 (MTTR)

| 장애 등급 | 목표 복구 시간 | 최대 허용 | 에스컬레이션 |
|:---------:|:--------------:|:---------:|--------------|
| P0 (서비스 중단) | 30분 | 2시간 | 즉시 PD 알림 |
| P1 (기능 장애) | 2시간 | 8시간 | 1시간 내 PD 알림 |
| P2 (품질 저하) | 24시간 | 48시간 | 일일 보고 |
| P3 (경미) | 72시간 | 7일 | 주간 보고 |

---

## 2. 콘텐츠 품질 기준

### 2.1 자동 품질 게이트

| 게이트 | 통과 기준 | 재작업 조건 | 최대 재시도 |
|--------|:---------:|:-----------:|:-----------:|
| **G1 (글 검수)** | 90점+ | 85점 미만 | 3회 |
| **G2 (이미지 검수)** | 85점+ | 80점 미만 | 3회 |
| **G3 (합성 검수)** | 85점+ | 80점 미만 | 2회 |

### 2.2 수동 품질 기준

| 지표 | 목표 | 측정 방법 |
|------|:----:|-----------|
| **PD 승인률** | 90%+ | (첫 제출 승인 / 전체 제출) |
| **재작업률** | 10% 이하 | (재작업 건수 / 전체 건수) |
| **폐기율** | 5% 이하 | (폐기 건수 / 전체 건수) |

---

## 3. 비즈니스 성과 기준

### 3.1 콘텐츠 생산성

| 지표 | 목표 | 측정 주기 |
|------|:----:|:---------:|
| **일일 생산량** | 2개 | 일간 |
| **주간 게시량** | 7개 | 주간 |
| **월간 게시량** | 25개+ | 월간 |
| **생산 비용** | 콘텐츠당 $0.50 이하 | 월간 |

### 3.2 인스타그램 성과 (Phase별)

| Phase | 기간 | 팔로워 목표 | 참여율 목표 |
|:-----:|------|:----------:|:----------:|
| 1 | 0~3개월 | 1,000 | 15%+ |
| 2 | 3~6개월 | 3,000 | 12%+ |
| 3 | 6~12개월 | 10,000 | 10%+ |
| 4 | 12~18개월 | 30,000 | 8%+ |

### 3.3 수익화 성과 (Phase별)

| Phase | 월 매출 목표 | 수익원 |
|:-----:|:----------:|--------|
| 1 | 0원 | (성장 집중) |
| 2 | 50만원 | PPL 1~2건 |
| 3 | 150만원 | PPL + 스폰서십 |
| 4 | 300만원+ | 다중 채널 |

---

## 4. 7일 가동 증명 체크리스트

> **목적:** Production Ready 선언 전 7일 연속 안정 가동 증명

### 필수 조건 (모두 충족)

```
□ 7일 연속 헬스체크 HEALTHY (98%+)
□ 자동 백업 7회 성공 (00:00 스케줄)
□ 자동 게시 시도 7회 중 6회 성공 (85%+)
□ 서킷 브레이커 OPEN 0회
□ P0/P1 장애 0건
□ 수동 개입 필요 0건
```

### 선택 조건 (80% 충족)

```
□ 커버 소스 자동 처리 5회+ (09:00 스케줄)
□ 텔레그램 알림 정상 발송
□ 크로스 포스팅 테스트 성공
□ 에러 집계 정상 동작
□ 롤백 테스트 성공
```

### 증명 문서

7일 가동 완료 시 아래 내용으로 증명서 작성:

```markdown
# SunFlow 7일 가동 증명서

**기간:** YYYY-MM-DD ~ YYYY-MM-DD
**작성자:** {담당자}
**승인자:** PD

## 결과 요약
| 지표 | 목표 | 실제 | 상태 |
|------|------|------|------|
| 가동률 | 98%+ | XX% | ✅/❌ |
| 게시 성공률 | 85%+ | XX% | ✅/❌ |
| 백업 성공률 | 100% | XX% | ✅/❌ |

## 장애 이력
(없음 / 상세 기록)

## 결론
□ Production Ready 승인
□ 추가 검증 필요: {사유}
```

---

## 5. 실패 시 조치 매트릭스

| 실패 유형 | 자동 조치 | 수동 조치 | 에스컬레이션 |
|-----------|-----------|-----------|--------------|
| **게시 실패** | 3회 재시도 | 수동 게시 | 3회 연속 실패 시 |
| **이미지 생성 실패** | 프롬프트 변경 재시도 | 대체 이미지 사용 | 5회 연속 실패 시 |
| **API 토큰 만료** | 알림 발송 | 토큰 갱신 | 즉시 |
| **디스크 부족** | 오래된 백업 삭제 | 수동 정리 | 90% 도달 시 |
| **서킷 OPEN** | 복구 대기 | 수동 리셋 | 30분 이상 지속 시 |

---

## 6. 모니터링 대시보드 지표

### 실시간 지표 (Streamlit)

```
1. 시스템 상태: HEALTHY / DEGRADED / UNHEALTHY
2. 오늘 게시: X/Y개 성공
3. 이번 주 게시: X/Y개 성공
4. 서킷 브레이커: 4/4 CLOSED
5. 최근 에러: X건 (24시간)
6. 디스크 사용량: XX%
7. 토큰 만료: XX일 남음
```

### 일간 리포트 지표

```
- 헬스체크 성공률
- 게시 성공/실패 건수
- 생성된 이미지 수
- API 호출 횟수/비용
- 에러 요약 (카테고리별)
```

---

## 서명

- [ ] **김부장**: 기준 정의 승인
- [ ] **PD**: 최종 확인

**승인일:** _______________

---

*SunFlow Performance Criteria v1.0*
*작성일: 2026-01-30*
