# 품질 판정 가이드 (김부장용)

> 버전: 1.0 | 최종 수정: 2026-02-12
> 이 문서는 김부장(Opus)이 콘텐츠 품질을 판정할 때 참조하는 기준입니다.

---

## 1. 판정 원칙

### 1.1 단일 기준 원칙
- `scoring_criteria.json`이 유일한 점수 기준
- 주관적 판단 배제, 정량 기준만 적용
- 기준에 없는 항목은 평가하지 않음

### 1.2 Safety ENUM 우선 원칙
- §22.11 Safety ENUM(SAFE/CAUTION/FORBIDDEN)이 모든 판정의 시작점
- Safety 불일치 = Auto-Fail (점수 산출 없이 F등급)

### 1.3 투명성 원칙
- 모든 판정에는 근거 명시
- 차원별 점수 + 상세 사유 기록

---

## 2. 점수 체계

### 2.1 5개 평가 차원

| 차원 | 배점 | 핵심 기준 |
|------|------|-----------|
| Safety Compliance | 30점 | §22.11-13 규칙 준수 |
| Content Accuracy | 25점 | food_data.json/toxicity_mapping.json 일치 |
| Structure Completeness | 20점 | 8개 슬라이드 완성도 |
| Tone Consistency | 15점 | Safety별 톤앤매너 |
| Readability | 10점 | 문장 품질, 가독성 |

**총점: 100점 + 보너스 최대 5점**

### 2.2 등급 기준

| 등급 | 점수 | 상태 | 조치 |
|------|------|------|------|
| A | 90-100 | EXCELLENT | 즉시 승인 가능 |
| B | 80-89 | GOOD | 경미한 수정 후 승인 |
| C | 70-79 | PASS | 수정 권장 |
| D | 50-69 | NEEDS_WORK | 재작업 필요 |
| F | 0-49 | FAIL | 전면 재작성 |

---

## 3. Auto-Fail 조건

다음 조건 중 하나라도 해당되면 점수 산출 없이 **F등급**:

1. **Safety ENUM 불일치**
   - 구조 ID의 Safety와 food_data.json의 Safety 불일치
   - 예: 구조 ID가 `127_SAFE_...`인데 food_data.json은 FORBIDDEN

2. **FORBIDDEN + 긍정 표현 3개 이상**
   - 금지 키워드: 건강에 좋, 영양 가득, 맛있, 좋아요, 추천, 급여량, 급여 방법, 영양 정보

3. **구조 ID 불일치**
   - 이미지-캡션-검증 간 구조 ID가 다른 경우

4. **슬라이드 3개 이상 누락**
   - 8개 중 5개 미만인 경우

5. **치명적 정보 오류**
   - food_data.json과 핵심 정보(안전도, 이름) 불일치

---

## 4. Safety별 판정 기준

### 4.1 SAFE 콘텐츠

```
[기대 톤]
- 긍정적, 권장하는 표현
- "급여해도 좋아요", "건강에 좋은"

[필수 헤더]
- [이미지 3번: 영양 정보]
- [이미지 4번: 급여 방법]
- [이미지 5번: 급여량 표]

[확인 항목]
□ 영양 성분이 food_data.json과 일치
□ 급여량 권장치가 명시됨
□ 긍정적 톤 유지
```

### 4.2 CAUTION 콘텐츠

```
[기대 톤]
- 조심스러운, 조건부 권장
- "소량만", "익혀서", "확인 후 급여"

[필수 헤더]
- [이미지 3번: 영양 정보]
- [이미지 4번: 급여 방법]
- [이미지 7번: 주의사항]

[확인 항목]
□ 주의사항이 명확히 기술됨
□ 조건부 급여 방법 제시
□ 경고 톤 적절히 포함
```

### 4.3 FORBIDDEN 콘텐츠

```
[기대 톤]
- 경고, 절대 금지
- "절대 급여 금지", "독성", "위험"

[필수 헤더]
- [이미지 3번: 위험 성분]
- [이미지 4번: 절대 급여 금지]
- [이미지 6번: 응급 대처법]
- [이미지 7번: 수의사 상담]

[확인 항목]
□ 긍정 표현 없음 (건강에 좋, 맛있, 좋아요 등)
□ 독성 성분이 toxicity_mapping.json과 일치
□ 응급 대처법 포함
□ 경고 톤 일관 유지
```

---

## 5. 판정 프로세스

### 5.1 자동 판정 (quality_protocol.py)

```bash
# 단일 콘텐츠 평가
python pipeline/quality_protocol.py --food-id 127 --verbose

# 결과 예시
품질 평가 결과: #127 대파
Safety: FORBIDDEN
총점: 85/100
등급: B (GOOD)
조치: 경미한 수정 후 승인
```

### 5.2 김부장 수동 검토

자동 판정 결과가 **C등급 이하**인 경우 김부장 수동 검토:

1. 자동 판정 결과 확인
2. 각 차원별 감점 사유 검토
3. 수정 필요 항목 명시
4. 최종 판정 (승인/반려/수정요청)

### 5.3 판정 기록

```json
{
  "food_id": 127,
  "auto_score": 85,
  "auto_grade": "B",
  "manual_review": true,
  "final_grade": "B",
  "reviewer": "김부장",
  "timestamp": "2026-02-12T10:30:00",
  "notes": "응급 대처법 표현 다듬기 권장"
}
```

---

## 6. 보너스 점수

최대 **5점**까지 추가 가능:

| 조건 | 점수 |
|------|------|
| toxicity_mapping.json 응급 대처법 정확 반영 | +2 |
| 품종별 주의사항 포함 (소형견/대형견/노견) | +2 |
| 계절/상황별 팁 포함 | +1 |

---

## 7. 예외 처리

### 7.1 데이터 누락

- food_data.json에 해당 food_id 없음 → 판정 불가, PD 보고
- toxicity_mapping.json에 FORBIDDEN 음식 없음 → Content Accuracy 최대 20점

### 7.2 캡션 파일 없음

- 해당 폴더에 caption.txt 없음 → Auto-Fail ("캡션 파일 없음")

### 7.3 판정 기준 충돌

- scoring_criteria.json과 이 문서 충돌 시 → scoring_criteria.json 우선
- 김부장 판단과 자동 판정 충돌 시 → 김부장 판단 우선 (사유 기록 필수)

---

## 8. 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 1.0 | 2026-02-12 | 초기 작성 |

---

_이 문서는 RULES.md §22.11-13과 연동됩니다._
