# 파일 관리 규칙

## 버전: 1.0
## 최종 수정: 2026-02-14

---

## 목적

파일 생성, 수정, 삭제 시 준수해야 할 안전 규칙을 정의한다.

---

## 규칙

### RULE-FILE-001: 생성 전 존재 확인

파일 생성 전 반드시 존재 여부를 확인한다.

```
if os.path.exists(file_path):
    # 기존 파일 처리 (백업 또는 스킵)
else:
    # 새 파일 생성
```

**기본값:** overwrite_approved=False

---

### RULE-FILE-002: 자동 백업

기존 파일 덮어쓰기 시 자동 백업 필수.

```
백업 위치: {원본폴더}/Backup/
백업 네이밍: {원본명}_{타임스탬프}.{확장자}

예시:
Pumpkin_Common_01_Cover.png
→ Backup/Pumpkin_Common_01_Cover_20260214_143022.png
```

---

### RULE-FILE-003: 리네이밍 = 복사+이동

파일 이름 변경 시 삭제가 아닌 복사+이동 방식 사용.

```
1. 새 이름으로 복사
2. 원본은 Backup/으로 이동
3. 원본 삭제 금지
```

---

### 원본 보존 원칙

- 소스 파일 원본 수정/이동 금지
- 00_Clean/ 내 파일은 읽기 전용 취급
- 골든 샘플 수정 금지

---

## 동결 규칙 (FREEZE)

| 규칙 | 내용 | 상태 |
|------|------|------|
| FREEZE-1 | regenerate 계열 차단 | 활성 |
| FREEZE-2 | 파이프라인 외부 실행 차단 | 활성 |
| FREEZE-3 | 배치 21건 상한 | 활성 |
| FREEZE-4 | Cloudinary write 동결 | **해제** (2026-02-14) |
| FREEZE-5 | QC 게이트 | 활성 |

---

## 위반 사례

| 위반 | 사례 |
|------|------|
| 존재 확인 없이 덮어쓰기 | 기존 파일 손실 |
| 백업 없이 수정 | 복구 불가 |
| 원본 직접 삭제 | 데이터 손실 |
| 클린 소스 수정 | 기준 훼손 |

---

## Validator 체크리스트

```
□ 생성 전 존재 확인 로직 있음
□ 덮어쓰기 시 백업 생성됨
□ Backup/ 폴더에 이전 버전 존재
□ 원본 클린 소스 미수정
□ FREEZE 규칙 준수
```
